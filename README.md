## 失真图像分类器

Started from August 2020

- #### 数据集

  './DistortedImageDatabase'

  __由于数据集过于庞大，并未直接上传，文件夹中给出基于MATLAB实现的失真叠加代码。__

  数据集由三种失真类型组成，分别是高斯噪声、运动模糊与JPEG压缩失真。而每种失真类型都有5种不同的失真程度。

  该数据集基于 “Waterloo Exploration Database”。其中包含了4744张高质量的各类图片。

  - 训练集

    从高质量图片中选取1000张，使用MATLAB生成失真图片。每一张原图对应生成15张失真图片，因此完成后的数据集共有15000张。

    经过MATLAB计算，该训练集对于RGB三个通道的均值和标准差如下：

    __Mean = [0.4955, 0.4544, 0.4145];	S = [0.2975, 0.2894, 0.3006]__.

  - 测试集

    从剩余的图片中随机选取100张图片，用以生成测试集。
    
    

  数据集中每一张图片的命名由三部分组成：第一部分为5位数字，用以表示原始高质量图片的序号；第二部分为2位数字，表示失真类型 （0-运动模糊；1-高斯噪声；2-JPEG压缩失真）；第三部分为1位数字，表示失真程度，取值为1~5，值越大，失真程度越高。

  

- #### 分类器
  ‘./DistortionClassification’

  分类器使用深度神经网络完成。神经网络的设计参照了VGG、GoogleNet、ResNet的架构。经过训练与测试，发现ResNet18较浅，训练速度较快，同时训练后具有较高的分类准确率，因此分类器以将输出的全连接层调整为3通道后的ResNet18为模型。

  - __训练__

  1. 为了有效减轻过拟合，使用k折交叉验证的方式（本训练过程中k=6）。使用MATLAB将数据集中的训练集随机划分成6组，每一次训练选其中1组作为验证集，剩余的作为训练集；每次单独训练；
  2. 训练过程的学习率依次使用0.001 -> 0.0001 -> 0.00001；
  3. 学习过程中统计每次的训练集loss与验证集loss，并保存每一次的验证集准确率，将最高准确率的模型进行保存；6折交叉验证后一共训练6个模型，将各个模型参数进行平均之后生成第7个模型。
  4. 使用数据集中的测试集对各个模型进行正确率测试。
  
  - __测试与结果__
  
    测试结果保存在文件 './DistortedImageClassification/TestInfo/test_info.xlsx' 中。
  
    第一列表示所用模型的序号；
  
    第二列中，1表示输入模型的图片是待测试图片所截取的中间200*200像素，5表示截取了待测试图片的中间以及四个角的各200\*200的图片块，10表示对图片进行中间及四个角的裁剪并将其水平或左右翻转后共构成10张图片块；
  
    第三列表示对于测试集的分类正确率；
  
    第四列给出了测试过程中分类错误的图片文件名和模型给出的错误分类，正确分类应为图片文件名中两个下划线之间的数字；
  
    测试结果表明，各个模型测试所得的正确率都在98%-99%之间，其中运动模糊（0）和JPEG压缩失真（2）之间容易混淆，而三种裁剪方式对分类正确率并没有实质性的影响。
    
    
  
- #### IQA

  


- #### 失真恢复